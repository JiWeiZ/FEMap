<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DNS | 前端知识小记</title>
    <meta name="description" content="Personal Front End Knowledge Map">
    <link rel="icon" href="/FEMap/logo.png">
  <link rel="manifest" href="/FEMap/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="./public/logo.png">
  <meta name="msapplication-TileImage" content="./public/logo.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/FEMap/assets/css/0.styles.46758652.css" as="style"><link rel="preload" href="/FEMap/assets/js/app.07aba767.js" as="script"><link rel="preload" href="/FEMap/assets/js/21.c86d268c.js" as="script"><link rel="prefetch" href="/FEMap/assets/js/10.6160a8a1.js"><link rel="prefetch" href="/FEMap/assets/js/11.58d7da13.js"><link rel="prefetch" href="/FEMap/assets/js/12.d82377e4.js"><link rel="prefetch" href="/FEMap/assets/js/13.69c6fc0a.js"><link rel="prefetch" href="/FEMap/assets/js/14.11c8990d.js"><link rel="prefetch" href="/FEMap/assets/js/15.e7e5ac4e.js"><link rel="prefetch" href="/FEMap/assets/js/16.74f923c2.js"><link rel="prefetch" href="/FEMap/assets/js/17.d4cda157.js"><link rel="prefetch" href="/FEMap/assets/js/18.47acc33a.js"><link rel="prefetch" href="/FEMap/assets/js/19.cd73ed28.js"><link rel="prefetch" href="/FEMap/assets/js/2.df56f01e.js"><link rel="prefetch" href="/FEMap/assets/js/20.46d38a64.js"><link rel="prefetch" href="/FEMap/assets/js/22.2a5c5ef9.js"><link rel="prefetch" href="/FEMap/assets/js/23.10cb81bf.js"><link rel="prefetch" href="/FEMap/assets/js/24.be70320c.js"><link rel="prefetch" href="/FEMap/assets/js/25.8ea26c41.js"><link rel="prefetch" href="/FEMap/assets/js/26.e52d061e.js"><link rel="prefetch" href="/FEMap/assets/js/27.f4257bb6.js"><link rel="prefetch" href="/FEMap/assets/js/28.da932e8e.js"><link rel="prefetch" href="/FEMap/assets/js/29.0c93adb6.js"><link rel="prefetch" href="/FEMap/assets/js/3.c20905f7.js"><link rel="prefetch" href="/FEMap/assets/js/30.a9c3edb7.js"><link rel="prefetch" href="/FEMap/assets/js/31.06c0bd16.js"><link rel="prefetch" href="/FEMap/assets/js/32.e8032021.js"><link rel="prefetch" href="/FEMap/assets/js/33.b18fa339.js"><link rel="prefetch" href="/FEMap/assets/js/34.3db52ecb.js"><link rel="prefetch" href="/FEMap/assets/js/35.6fc0c7d0.js"><link rel="prefetch" href="/FEMap/assets/js/36.2635250b.js"><link rel="prefetch" href="/FEMap/assets/js/37.04bd4304.js"><link rel="prefetch" href="/FEMap/assets/js/38.eca7423d.js"><link rel="prefetch" href="/FEMap/assets/js/39.7bc43a19.js"><link rel="prefetch" href="/FEMap/assets/js/4.44c0aa72.js"><link rel="prefetch" href="/FEMap/assets/js/40.d012cce0.js"><link rel="prefetch" href="/FEMap/assets/js/41.3c942633.js"><link rel="prefetch" href="/FEMap/assets/js/42.a1671e8d.js"><link rel="prefetch" href="/FEMap/assets/js/43.221d040e.js"><link rel="prefetch" href="/FEMap/assets/js/44.01b4fee0.js"><link rel="prefetch" href="/FEMap/assets/js/45.f2e2ea06.js"><link rel="prefetch" href="/FEMap/assets/js/46.7ec82695.js"><link rel="prefetch" href="/FEMap/assets/js/47.0e955f03.js"><link rel="prefetch" href="/FEMap/assets/js/48.91c5d6d5.js"><link rel="prefetch" href="/FEMap/assets/js/49.568d659d.js"><link rel="prefetch" href="/FEMap/assets/js/5.4007d5b2.js"><link rel="prefetch" href="/FEMap/assets/js/50.ed024948.js"><link rel="prefetch" href="/FEMap/assets/js/51.e33531d0.js"><link rel="prefetch" href="/FEMap/assets/js/52.ad8a1762.js"><link rel="prefetch" href="/FEMap/assets/js/53.267f2d4f.js"><link rel="prefetch" href="/FEMap/assets/js/54.65af1a35.js"><link rel="prefetch" href="/FEMap/assets/js/55.dc78eaa5.js"><link rel="prefetch" href="/FEMap/assets/js/56.11966346.js"><link rel="prefetch" href="/FEMap/assets/js/57.df055972.js"><link rel="prefetch" href="/FEMap/assets/js/58.8a361639.js"><link rel="prefetch" href="/FEMap/assets/js/59.998b1de9.js"><link rel="prefetch" href="/FEMap/assets/js/6.41d00c0a.js"><link rel="prefetch" href="/FEMap/assets/js/60.b5c2cae7.js"><link rel="prefetch" href="/FEMap/assets/js/61.f2cc1d27.js"><link rel="prefetch" href="/FEMap/assets/js/62.7be0ab04.js"><link rel="prefetch" href="/FEMap/assets/js/63.6ebfd592.js"><link rel="prefetch" href="/FEMap/assets/js/64.e96b5edb.js"><link rel="prefetch" href="/FEMap/assets/js/65.03c5da29.js"><link rel="prefetch" href="/FEMap/assets/js/66.ef16a307.js"><link rel="prefetch" href="/FEMap/assets/js/67.e0c5beb3.js"><link rel="prefetch" href="/FEMap/assets/js/68.b436f696.js"><link rel="prefetch" href="/FEMap/assets/js/69.79957ff2.js"><link rel="prefetch" href="/FEMap/assets/js/7.41c30484.js"><link rel="prefetch" href="/FEMap/assets/js/70.a0613b33.js"><link rel="prefetch" href="/FEMap/assets/js/8.db996418.js"><link rel="prefetch" href="/FEMap/assets/js/9.c21a2975.js">
    <link rel="stylesheet" href="/FEMap/assets/css/0.styles.46758652.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/FEMap/" class="home-link router-link-active"><!----> <span class="site-name">前端知识小记</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/JiWeiZ/FEMap" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com/JiWeiZ/FEMap" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>JS</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/JS/array.html" class="sidebar-link">数组相关</a></li><li><a href="/FEMap/JS/object.html" class="sidebar-link">对象相关</a></li><li><a href="/FEMap/JS/function.html" class="sidebar-link">函数和闭包</a></li><li><a href="/FEMap/JS/event.html" class="sidebar-link">事件代理</a></li><li><a href="/FEMap/JS/event-loop.html" class="sidebar-link">Event Loop</a></li><li><a href="/FEMap/JS/distance.html" class="sidebar-link">页面各种距离</a></li><li><a href="/FEMap/JS/regex.html" class="sidebar-link">正则表达式</a></li><li><a href="/FEMap/JS/ajax.html" class="sidebar-link">Ajax</a></li><li><a href="/FEMap/JS/high-level.html" class="sidebar-link">高阶函数</a></li><li><a href="/FEMap/JS/byhand.html" class="sidebar-link">手写系列</a></li><li><a href="/FEMap/JS/repaint-reflow.html" class="sidebar-link">重绘和回流</a></li><li><a href="/FEMap/JS/recursive.html" class="sidebar-link">递归的优化</a></li><li><a href="/FEMap/JS/GC.html" class="sidebar-link">垃圾收集和内存泄漏</a></li><li><a href="/FEMap/JS/async-solution.html" class="sidebar-link">异步解决方案</a></li><li><a href="/FEMap/JS/design-patterns.html" class="sidebar-link">设计模式</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>CSS</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/CSS/css-selector.html" class="sidebar-link">CSS选择器</a></li><li><a href="/FEMap/CSS/text.html" class="sidebar-link">文本</a></li><li><a href="/FEMap/CSS/visual-format.html" class="sidebar-link">基本视觉格式化</a></li><li><a href="/FEMap/CSS/float-position.html" class="sidebar-link">浮动和定位</a></li><li><a href="/FEMap/CSS/visibility-z-index.html" class="sidebar-link">可见性和z-index</a></li><li><a href="/FEMap/CSS/layout.html" class="sidebar-link">布局</a></li><li><a href="/FEMap/CSS/CSS3-flex.html" class="sidebar-link">CSS3: flex</a></li><li><a href="/FEMap/CSS/CSS3-grid.html" class="sidebar-link">CSS3: grid</a></li><li><a href="/FEMap/CSS/CSS3-animation.html" class="sidebar-link">CSS3: animation</a></li><li><a href="/FEMap/CSS/CSS3-background.html" class="sidebar-link">CSS3: background</a></li><li><a href="/FEMap/CSS/CSS3-border.html" class="sidebar-link">CSS3: border</a></li><li><a href="/FEMap/CSS/CSS3-font.html" class="sidebar-link">CSS3: font</a></li><li><a href="/FEMap/CSS/CSS3-gradient.html" class="sidebar-link">CSS3: gradient</a></li><li><a href="/FEMap/CSS/CSS3-transform.html" class="sidebar-link">CSS3: transform</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>网络</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/Network/network-architecture.html" class="sidebar-link">五层协议</a></li><li><a href="/FEMap/Network/link-layer.html" class="sidebar-link">链路层</a></li><li><a href="/FEMap/Network/network-layer.html" class="sidebar-link">网络层</a></li><li><a href="/FEMap/Network/transport-layer.html" class="sidebar-link">运输层</a></li><li><a href="/FEMap/Network/cross-domain.html" class="sidebar-link">跨域处理</a></li><li><a href="/FEMap/Network/DNS.html" aria-current="page" class="active sidebar-link">DNS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/FEMap/Network/DNS.html#dns-是什么" class="sidebar-link">DNS 是什么</a></li><li class="sidebar-sub-header"><a href="/FEMap/Network/DNS.html#查询过程" class="sidebar-link">查询过程</a></li><li class="sidebar-sub-header"><a href="/FEMap/Network/DNS.html#dns的记录类型" class="sidebar-link">DNS的记录类型</a></li><li class="sidebar-sub-header"><a href="/FEMap/Network/DNS.html#相关优化" class="sidebar-link">相关优化</a></li></ul></li><li><a href="/FEMap/Network/CDN.html" class="sidebar-link">CDN</a></li><li><a href="/FEMap/Network/cache.html" class="sidebar-link">缓存策略</a></li><li><a href="/FEMap/Network/network-process.html" class="sidebar-link">输入url到显示页面的步骤(以HTTP为例)</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>一些题目</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/Questions/questions.html" class="sidebar-link">一些面试题</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>算法/数据结构</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/Algorithm/BST.html" class="sidebar-link">BST</a></li><li><a href="/FEMap/Algorithm/AVL.html" class="sidebar-link">AVL</a></li><li><a href="/FEMap/Algorithm/sort.html" class="sidebar-link">排序算法</a></li><li><a href="/FEMap/Algorithm/search.html" class="sidebar-link">搜索算法</a></li><li><a href="/FEMap/Algorithm/dynamic-program.html" class="sidebar-link">动态规划</a></li><li><a href="/FEMap/Algorithm/greedy.html" class="sidebar-link">贪心算法</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>工程化</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/" aria-current="page" class="sidebar-link">前端知识小记</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/Vue/responsive.html" class="sidebar-link">响应式原理</a></li><li><a href="/FEMap/Vue/v-model.html" class="sidebar-link">v-model</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Node</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/" aria-current="page" class="sidebar-link">前端知识小记</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Express</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/" aria-current="page" class="sidebar-link">前端知识小记</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Koa</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/" aria-current="page" class="sidebar-link">前端知识小记</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Git</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/FEMap/" aria-current="page" class="sidebar-link">前端知识小记</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="dns"><a href="#dns" class="header-anchor">#</a> DNS</h1> <p>参考文章：</p> <ol><li><a href="http://www.ruanyifeng.com/blog/2016/06/dns.html" target="_blank" rel="noopener noreferrer">阮一峰：DNS 原理入门<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://juejin.im/entry/591969808d6d81005882e06f" target="_blank" rel="noopener noreferrer">写给前端工程师的 DNS 基础知识<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://zhuanlan.zhihu.com/p/28305778" target="_blank" rel="noopener noreferrer">DNS域名解析解剖<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <h2 id="dns-是什么"><a href="#dns-是什么" class="header-anchor">#</a> DNS 是什么</h2> <p>答：DNS （Domain Name System，域名系统），是一个 <strong>域名</strong> 和 <strong>IP</strong> 相互映射的分布式数据库，能根据域名查出 IP 地址。</p> <p>先从URL说起。一般来说，访问网络资源的途径就是访问其URL。URL的格式如下：</p> <p><img src="https://upload-images.jianshu.io/upload_images/301420-e308f1b76b1bfc97.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/902/format/webp" alt="img"></p> <ul><li>protocol 协议，常用的协议是http，https，ftp等等</li> <li>hostname 主机地址，可以是域名，也可以是IP地址</li> <li>port 端口 http协议默认端口是：80端口，如果不写默认就是:80端口</li> <li>path 路径 网络资源在服务器中的指定路径</li> <li>parameter 参数 如果要向服务器传入参数，在这部分输入</li> <li>query 查询字符串 如果需要从服务器那里查询内容，在这里编辑</li> <li>fragment 片段 网页中可能会分为不同的片段，如果想访问网页后直接到达指定位置，可以在这部分设置</li></ul> <p>我们这里所说的域名实际上就是URL的hostname部分。互联网诞生之初是采用IP地址访问的，但IP很难记，直接通过ip访问网站让人很不爽，所以人们发明了DNS服务器，这样就能通过一串有规律的字符——域名访问网站了。</p> <h3 id="域名解析"><a href="#域名解析" class="header-anchor">#</a> 域名解析</h3> <p>通过域名访问网站的第一步就是进行域名解析，举例来说，如果你要访问域名<code>www.baidu.com</code>，首先要通过DNS查出它的IP地址。<code>www.baidu.com</code>对应的IP地址有2个：<code>111.13.100.91</code>和<code>111.13.100.92</code>（在地址栏键入这2个IP也可以访问百度主页），从<code>www.baidu.com</code>得到<code>111.13.100.91</code>的过程就是域名解析。</p> <h3 id="域名的层级"><a href="#域名的层级" class="header-anchor">#</a> 域名的层级</h3> <p>域名的层级结构如下：低级域名写在前面，并且以<code>.</code>分割：</p> <div class="language- extra-class"><pre class="language-text"><code>三级域名.次级域名.顶级域名.根域名
</code></pre></div><p>还是以www.baidu.com为例，实际上www.baidu.com的真正域名是www.baidu.com.root。但是根域名对于世界上所有的域名来说都是一样的，所有平时省略不写。</p> <p>根域名的下一级，叫做&quot;顶级域名&quot;（top-level domain，缩写为TLD），比如.com、.net；再下一级叫做&quot;次级域名&quot;（second-level domain，缩写为SLD），比如www.baidu.com里面的.baidu，这一级域名是用户可以注册的；再下一级是主机名（host），比如www.baidu.com里面的www，又称为&quot;三级域名&quot;，这是用户在自己的域里面为服务器分配的名称，是用户可以任意分配的。</p> <p>像com这样的顶级域名，由ICANN 严格控制，是不允许随便创建的。顶级域名分两类:</p> <ol><li>通用顶级域名</li> <li>国家顶级域名</li></ol> <p>通用顶级域名常见的如.com、 .org、.edu等， 国家顶级域名如我国的.cn， 美国的.us。还有一些常用的其他域名，如.me, .io等等。不同域名的价格也不尽相同。</p> <p><em>阿里云的域名申请截图</em></p> <p><img src="/FEMap/assets/img/1545200423080.cc91ba03.png" alt="1545200423080"></p> <p><strong>DNS依靠UDP传输</strong></p> <h2 id="查询过程"><a href="#查询过程" class="header-anchor">#</a> 查询过程</h2> <p>工具软件<code>dig</code>可以显示整个查询过程。（参考：<a href="https://nil.uniza.sk/how-install-dig-dns-tool-windows-10/" target="_blank" rel="noopener noreferrer">如何在windows中安装dig？<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 以及 <a href="ftp://ftp.nominum.com/pub/isc/bind9/9.9.6/BIND9.9.6.x86.zip">dig工具包BIND9.9.6.x86下载地址</a>）</p> <ol><li><p>第1步，查找缓存</p> <ol><li><p>查找浏览器缓存。</p> <p>首先浏览器会去搜索自身的DNS缓存，看缓存有没有过期，过期的话缓存的解析就结束了（chrome缓存的时间只有一分钟，查看chrome的缓存可打开：chrome://net-internals/#dns ）。</p></li> <li><p>查找系统缓存。</p> <p>如果用户的浏览器缓存中没有，浏览器会查找操作系统缓存中是否有这个域名对应的DNS解析结果。
在Windows中可以通过C:\Windows\System32\drivers\etc\hosts文件来设置，你可以将任何域名解析到任何能够访问的IP地址。如果你在这里指定了一个域名对应的IP地址，那么浏览器会首先使用这个IP地址。例如，我们在测试时可以将一个域名解析到一台测试服务器上，这样不用修改任何代码就能测试到单独服务器上的代码的业务逻辑是否正确。正是因为有这种本地DNS解析的规程，所以黑客就有可能通过修改你的域名解析来把特定的域名解析到它指定的IP地址上，导致这些域名被劫持。</p></li> <li><p>查找路由器缓存。
如果系统缓存中也找不到，那么查询请求就会发向路由器，它一般会有自己的DNS缓存。</p></li></ol></li> <li><p>第2步，向 本地DNS服务器 请求域名解析。
确认本地无缓存，会查询本地DNS服务器（Local DNs），通常是网络服务商提供的DNS解析服务。在我们的网络配置中都会有&quot;DNS服务器地址&quot;这一项。大约80%的域名解析都到这里就已经完成了。<br></p> <p><img src="https://user-gold-cdn.xitu.io/2017/5/15/bac5fa8fa23717a1a2eea13a61a4c04d?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="mark"></p></li> <li><p>第3步，DNS递归查询。
如果前面几步都查询不到，就只能进行递归的搜索了。从根域、顶级域、二级域名等一次往下查询：</p> <ol><li>当域名服务器收到本地DNS服务器发出的迭代查询请求报文时，要么给出所要查询的IP地址，要么告诉本地服务器：“你下一步应当向哪一个域名服务器进行查询”。</li> <li>根域名服务器通常是把自己知道的顶级域名服务器的IP地址告诉本地域名服务器，让本地域名服务器再向顶级域名服务器查询。</li> <li>顶级域名服务器收到本地DNS服务器的查询请求后，要么给出所要查询的IP地址，要么告诉本地服务器下一步应当向哪一个权限域名服务器进行查询......最后，知道了所要解析的IP地址或报错，然后把这个结果返回给发起查询的主机。</li></ol></li></ol> <p><img src="https://pic2.zhimg.com/80/v2-4fcef604d306308b0ed3c2ea4ed7ea09_hd.jpg" alt="img"></p> <h2 id="dns的记录类型"><a href="#dns的记录类型" class="header-anchor">#</a> DNS的记录类型</h2> <p>域名与IP之间的对应关系，称为&quot;记录&quot;（record）。根据使用场景，&quot;记录&quot;可以分成不同的类型（type），前面已经看到了有<code>A</code>记录和<code>NS</code>记录。</p> <p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016061501.png" alt="img"></p> <ol><li><p><code>A</code>：地址记录（Address），返回域名指向的IP地址。</p></li> <li><p><code>NS</code>：域名服务器记录（Name Server），返回保存下一级域名信息的服务器地址。该记录只能设置为域名，不能设置为IP地址。</p></li> <li><p><code>MX</code>：邮件记录（Mail eXchange），返回接收电子邮件的服务器地址。</p></li> <li><p><code>CNAME</code>：规范名称记录（Canonical Name），返回另一个域名，即<strong>当前查询的域名是另一个域名的跳转</strong>。CNAME在做CDN加速的时候是一个非常重要配置项。</p></li> <li><p><code>PTR</code>：逆向查询记录（Pointer Record），只用于从IP地址查询域名</p></li></ol> <h2 id="相关优化"><a href="#相关优化" class="header-anchor">#</a> 相关优化</h2> <p>1、减少DNS查找，避免重定向</p> <p>浏览器DNS缓存 、计算机DNS缓存、 服务器DNS缓存、使用Keep-Alive特性 来减少DNS查找。考虑影响DNS缓存的因素：</p> <ul><li>服务器可以设置TTL值表示DNS记录的存活时间。本机DNS缓存将根据这个TTL值判断DNS记录什么时候被抛弃，这个TTL值一般都不会设置很大，主要是考虑到快速故障转移的问题。</li> <li>浏览器DNS缓存也有自己的过期时间，这个时间是独立于本机DNS缓存的，相对也比较短，例如chrome只有1分钟左右。</li> <li>浏览器DNS记录的数量也有限制，如果短时间内访问了大量不同域名的网站，则较早的DNS记录将被抛弃，必须重新查找。不过即使浏览器丢弃了DNS记录，操作系统的DNS缓存也有很大机率保留着该记录，这样可以避免通过网络查询而带来的延迟。</li></ul> <p>2、DNS的预解析</p> <ul><li>可以通过用meta信息来告知浏览器, 我这页面要做DNS预解析</li></ul> <div class="language- extra-class"><pre class="language-text"><code> &lt;meta http-equiv=&quot;x-dns-prefetch-control&quot; content=&quot;on&quot; /&gt;
</code></pre></div><ul><li>可以使用link标签来强制对DNS做预解析:</li></ul> <div class="language- extra-class"><pre class="language-text"><code> &lt;link rel=&quot;dns-prefetch&quot; href=&quot;http://ke.qq.com/&quot; /&gt;
</code></pre></div><ul><li>当客户端的DNS缓存为空时，DNS查找的数量与Web页面中唯一主机名的数量相等。减少唯一主机名的数量就可以减少DNS查找的数量。较少的域名来减少DNS查找（2-4个主机）</li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/JiWeiZ/FEMap/edit/master/docs/Network/DNS.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">12/19/2018, 10:54:39 PM</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/FEMap/Network/cross-domain.html" class="prev">
          跨域处理
        </a></span> <span class="next"><a href="/FEMap/Network/CDN.html">
          CDN
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/FEMap/assets/js/app.07aba767.js" defer></script><script src="/FEMap/assets/js/21.c86d268c.js" defer></script>
  </body>
</html>
